# 🕴️ Customer Insights

#### 1. What are the names of all the countries in the country table?

```sql
select country_name
from insights.country;
```

![image](https://github.com/IshaBhardwaj15/Customer-Insights/blob/main/ss/Screenshot%20(102).png)

***

#### 2. What is the total number of customers in the customers table?

```sql
select COUNT(distinct customer_id) as no_of_customers
from insights.customers;
```

![image](https://github.com/IshaBhardwaj15/Customer-Insights/blob/main/ss/Screenshot%20(103).png)

***

#### 3. What is the average age of customers who can receive marketing emails (can_email is set to 'yes')?

```sql
select AVG(age) as Average_Age
from insights.customers
where can_email='yes';
```

![image](https://github.com/IshaBhardwaj15/Customer-Insights/blob/main/ss/Screenshot%20(104).png)

***

#### 4. How many orders were made by customers aged 30 or older?

```sql
select COUNT(o.order_id) as no_of_orders
from insights.orders as o
join insights.customers as c on 
	c.customer_id=o.customer_id
where c.age>=30
```

![image](https://github.com/IshaBhardwaj15/Customer-Insights/blob/main/ss/Screenshot%20(113).png)

***

#### 5. What is the total revenue generated by each product category?

```sql
select category,SUM(price) as total_revenue
from insights.products
group by category
```

![image](https://github.com/IshaBhardwaj15/Customer-Insights/blob/main/ss/Screenshot%20(106).png)

***

#### 6. What is the average price of products in the 'food' category?

```sql
select AVG(price) as average_price_for_food_category
from insights.products
where category='food'
```

![image](https://github.com/IshaBhardwaj15/Customer-Insights/blob/main/ss/Screenshot%20(107).png)

***

#### 7. How many orders were made in each sales channel (sales_channel column) in the orders table?

```sql
from insights.orders
group by sales_channel
```

![image](https://github.com/IshaBhardwaj15/Customer-Insights/blob/main/ss/Screenshot%20(109).png)

***

#### 8.What is the date of the latest order made by a customer who can receive marketing emails?

```sql
select top 1 o.date_shop as latest_order_date
from insights.orders as o
join insights.customers as c on
	c.customer_id=o.customer_id
where c.can_email='yes'
order by o.date_shop desc
```

![image](https://github.com/IshaBhardwaj15/Customer-Insights/blob/main/ss/Screenshot%20(110).png)

***

#### 9. What is the name of the country with the highest number of orders?

```sql
select  top 1 c.country_name, COUNT(o.order_id) as order_count
from insights.country as c
join insights.orders as o on
	o.country_id=c.country_id
group by c.country_name
order by order_count desc
```

![image](https://github.com/IshaBhardwaj15/Customer-Insights/blob/main/ss/Screenshot%20(111).png)

***

#### 10. What is the average age of customers who made orders in the 'vitamins' product category?

```sql
select AVG(c.age) as average_age
from insights.orders as o
join insights.customers as c on
	c.customer_id=o.customer_id
join insights.baskets as b on
	b.order_id=o.order_id
join insights.products as p on
	p.product_id=b.product_id
where p.category='vitamins'
```


![image](https://github.com/IshaBhardwaj15/Customer-Insights/blob/main/ss/Screenshot%20(112).png)
